> **Note**: This is a GitHub-friendly Markdown preview generated with Pandoc.
> For the full report with properly rendered equations, see the [PDF version](report_*.pdf).

---

---
author:
- Nexus Research Agent
date: 2025-11-26
title: |
  All-Atom Generative Models for Biomolecular Design:  
  Unified Framework, Integration, and Empirical Performance
---

# Introduction

All-atom generative models are reshaping computational structural biology and drug discovery by enabling *programmable* design of biomolecules at the level of individual atoms. In contrast to earlier residue- or backbone-level approaches, these models operate directly on three-dimensional coordinates and chemical identities for every atom in a system, spanning proteins, ligands, nucleic acids, metals, and other cofactors. This atomic resolution is essential because the key determinants of molecular recognition—electrostatics, hydrogen bonding, steric complementarity, desolvation, and dispersion—are inherently local and anisotropic at the atomic scale.

Classical protein design pipelines model a coarse-grained distribution over amino-acid sequences ![S](https://latex.codecogs.com/png.latex?S "S") and backbone geometries ![B](https://latex.codecogs.com/png.latex?B "B"),

![\begin{equation}
    p\_{\text{res}}(S,B),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Bres%7D%7D%28S%2CB%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{res}}(S,B),
\end{equation}")

and defer atomic detail to separate side-chain packing, docking, and refinement stages. By contrast, all-atom generative models aim to learn and sample from a distribution

![\begin{equation}
    p\_{\text{all-atom}}(X,Z),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Ball-atom%7D%7D%28X%2CZ%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{all-atom}}(X,Z),
\end{equation}")

where ![X \in \mathbb{R}^{3N}](https://latex.codecogs.com/png.latex?X%20%5Cin%20%5Cmathbb%7BR%7D%5E%7B3N%7D "X \in \mathbb{R}^{3N}") denotes the 3D coordinates of all ![N](https://latex.codecogs.com/png.latex?N "N") atoms and ![Z](https://latex.codecogs.com/png.latex?Z "Z") encodes their discrete types (element, charge, bonding, residue membership, etc.). In practice, design tasks require *conditional* variants

![\begin{equation}
    p\_{\text{all-atom}}(X,Z \mid C),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Ball-atom%7D%7D%28X%2CZ%20%5Cmid%20C%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{all-atom}}(X,Z \mid C),
\end{equation}")

with ![C](https://latex.codecogs.com/png.latex?C "C") representing conditioning information such as a target binding site, an epitope, a ligand, a nucleic-acid scaffold, symmetry constraints, or atom-level interaction patterns (e.g., specified hydrogen bonds or solvent exposure). Sampling

![\begin{equation}
    (X^{(1)},Z^{(1)}), \dots, (X^{(K)},Z^{(K)}) \sim p\_\theta(X,Z \mid C)
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%28X%5E%7B%281%29%7D%2CZ%5E%7B%281%29%7D%29%2C%20%5Cdots%2C%20%28X%5E%7B%28K%29%7D%2CZ%5E%7B%28K%29%7D%29%20%5Csim%20p_%5Ctheta%28X%2CZ%20%5Cmid%20C%29%0A%5Cend%7Bequation%7D "\begin{equation}
    (X^{(1)},Z^{(1)}), \dots, (X^{(K)},Z^{(K)}) \sim p_\theta(X,Z \mid C)
\end{equation}")

from a learned approximation ![p\_\theta](https://latex.codecogs.com/png.latex?p_%5Ctheta "p_\theta") then yields candidate designs that are, in principle, already physically detailed at the atomic level.

Achieving this goal is challenging for several reasons:

- **Geometric symmetry.** The target distribution must respect the symmetries of three-dimensional space: global translations and rotations of a complex should not change its physical plausibility. Mathematically, this is expressed as ![\mathrm{E}(3)](https://latex.codecogs.com/png.latex?%5Cmathrm%7BE%7D%283%29 "\mathrm{E}(3)")-equivariance: for a generative mapping ![f](https://latex.codecogs.com/png.latex?f "f"),

  ![\begin{equation}
          f(RX + t, Z, C) = R f(X,Z,C) + t,
      
  \end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20f%28RX%20%2B%20t%2C%20Z%2C%20C%29%20%3D%20R%20f%28X%2CZ%2CC%29%20%2B%20t%2C%0A%20%20%20%20%0A%5Cend%7Bequation%7D "\begin{equation}
          f(RX + t, Z, C) = R f(X,Z,C) + t,
      
  \end{equation}")

  for all rotations ![R \in \mathrm{SO}(3)](https://latex.codecogs.com/png.latex?R%20%5Cin%20%5Cmathrm%7BSO%7D%283%29 "R \in \mathrm{SO}(3)") and translations ![t \in \mathbb{R}^3](https://latex.codecogs.com/png.latex?t%20%5Cin%20%5Cmathbb%7BR%7D%5E3 "t \in \mathbb{R}^3").

- **Interaction hierarchy.** The distribution must encode a rich hierarchy of interactions: short-range steric repulsion and bond geometry, medium-range hydrogen-bond and packing networks, and longer-range electrostatics and allostery.

- **Computational tractability.** Naive attention over ![N](https://latex.codecogs.com/png.latex?N "N") atoms scales as ![\mathcal{O}(N^2)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%28N%5E2%29 "\mathcal{O}(N^2)"), which is prohibitive for realistic complexes with ![N](https://latex.codecogs.com/png.latex?N "N") in the ![10^3](https://latex.codecogs.com/png.latex?10%5E3 "10^3")–![10^5](https://latex.codecogs.com/png.latex?10%5E5 "10^5") range.

Recent advances address these challenges by combining three key ingredients:

1.  **Diffusion-based generative modeling in 3D.** Diffusion models, also known as score-based generative models, define a forward process that gradually corrupts data with noise and a learned reverse process that reconstructs clean samples. For molecular coordinates, a common continuous-time forward process is the variance-preserving stochastic differential equation (SDE)

    ![\begin{equation}
            dX_t = -\frac{1}{2}\beta(t) X_t\\dt + \sqrt{\beta(t)}\\dW_t,
            \qquad t \in \[0,1\],
        
    \end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20dX_t%20%3D%20-%5Cfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%5C%2Cdt%20%2B%20%5Csqrt%7B%5Cbeta%28t%29%7D%5C%2CdW_t%2C%0A%20%20%20%20%20%20%20%20%5Cqquad%20t%20%5Cin%20%5B0%2C1%5D%2C%0A%20%20%20%20%0A%5Cend%7Bequation%7D "\begin{equation}
            dX_t = -\frac{1}{2}\beta(t) X_t\,dt + \sqrt{\beta(t)}\,dW_t,
            \qquad t \in [0,1],
        
    \end{equation}")

    where ![X_t \in \mathbb{R}^{3N}](https://latex.codecogs.com/png.latex?X_t%20%5Cin%20%5Cmathbb%7BR%7D%5E%7B3N%7D "X_t \in \mathbb{R}^{3N}") are noisy coordinates at time ![t](https://latex.codecogs.com/png.latex?t "t"), ![\beta(t)](https://latex.codecogs.com/png.latex?%5Cbeta%28t%29 "\beta(t)") is a noise schedule, and ![W_t](https://latex.codecogs.com/png.latex?W_t "W_t") is standard Brownian motion. Starting from clean data ![X_0](https://latex.codecogs.com/png.latex?X_0 "X_0"), this process yields

    ![\begin{equation}
            X_t = \alpha_t X_0 + \sigma_t \epsilon, \qquad \epsilon \sim \mathcal{N}(0,I),
        
    \end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20X_t%20%3D%20%5Calpha_t%20X_0%20%2B%20%5Csigma_t%20%5Cepsilon%2C%20%5Cqquad%20%5Cepsilon%20%5Csim%20%5Cmathcal%7BN%7D%280%2CI%29%2C%0A%20%20%20%20%0A%5Cend%7Bequation%7D "\begin{equation}
            X_t = \alpha_t X_0 + \sigma_t \epsilon, \qquad \epsilon \sim \mathcal{N}(0,I),
        
    \end{equation}")

    with analytically known ![\alpha_t,\sigma_t](https://latex.codecogs.com/png.latex?%5Calpha_t%2C%5Csigma_t "\alpha_t,\sigma_t"). The reverse-time SDE,

    ![\begin{equation}
            dX_t = \Big\[-\tfrac{1}{2}\beta(t) X_t - \beta(t)\\\nabla\_{X_t} \log p_t(X_t \mid C)\Big\]dt
                + \sqrt{\beta(t)}\\d\bar{W}\_t,
        
    \end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20dX_t%20%3D%20%5CBig%5B-%5Ctfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%20-%20%5Cbeta%28t%29%5C%2C%5Cnabla_%7BX_t%7D%20%5Clog%20p_t%28X_t%20%5Cmid%20C%29%5CBig%5Ddt%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%5Csqrt%7B%5Cbeta%28t%29%7D%5C%2Cd%5Cbar%7BW%7D_t%2C%0A%20%20%20%20%0A%5Cend%7Bequation%7D "\begin{equation}
            dX_t = \Big[-\tfrac{1}{2}\beta(t) X_t - \beta(t)\,\nabla_{X_t} \log p_t(X_t \mid C)\Big]dt
                + \sqrt{\beta(t)}\,d\bar{W}_t,
        
    \end{equation}")

    is parameterized by a neural network ![s\_\theta(X_t,t,C) \approx \nabla\_{X_t}\log p_t(X_t \mid C)](https://latex.codecogs.com/png.latex?s_%5Ctheta%28X_t%2Ct%2CC%29%20%5Capprox%20%5Cnabla_%7BX_t%7D%5Clog%20p_t%28X_t%20%5Cmid%20C%29 "s_\theta(X_t,t,C) \approx \nabla_{X_t}\log p_t(X_t \mid C)"), the *score function*. Integrating this reverse SDE from ![t=1](https://latex.codecogs.com/png.latex?t%3D1 "t=1") (pure noise) to ![t=0](https://latex.codecogs.com/png.latex?t%3D0 "t=0") yields samples from the learned conditional distribution over all-atom structures.

2.  **Equivariant geometric neural networks.** To respect 3D symmetries and encode local geometry, modern models use ![\mathrm{E}(3)](https://latex.codecogs.com/png.latex?%5Cmathrm%7BE%7D%283%29 "\mathrm{E}(3)")-equivariant message-passing and attention layers that operate on atomistic graphs. A typical update for atom ![i](https://latex.codecogs.com/png.latex?i "i") uses invariant scalars such as distances ![r\_{ij} = \\x_i - x_j\\](https://latex.codecogs.com/png.latex?r_%7Bij%7D%20%3D%20%5C%7Cx_i%20-%20x_j%5C%7C "r_{ij} = \|x_i - x_j\|") and relative vectors ![(x_i - x_j)](https://latex.codecogs.com/png.latex?%28x_i%20-%20x_j%29 "(x_i - x_j)"):

    ![\begin{align}
            m\_{ij} &= \phi_m\big(h_i, h_j, e\_{ij}, r\_{ij}, C\big), \\
            h_i' &= \phi_h\Big(h_i, \sum\_{j \in \mathcal{N}(i)} m\_{ij}\Big), \\
            x_i' &= x_i + \sum\_{j \in \mathcal{N}(i)} \phi_x\big(h_i, h_j, e\_{ij}, r\_{ij}, C\big)(x_i - x_j),
        
    \end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%20%20%20%20m_%7Bij%7D%20%26%3D%20%5Cphi_m%5Cbig%28h_i%2C%20h_j%2C%20e_%7Bij%7D%2C%20r_%7Bij%7D%2C%20C%5Cbig%29%2C%20%5C%5C%0A%20%20%20%20%20%20%20%20h_i%27%20%26%3D%20%5Cphi_h%5CBig%28h_i%2C%20%5Csum_%7Bj%20%5Cin%20%5Cmathcal%7BN%7D%28i%29%7D%20m_%7Bij%7D%5CBig%29%2C%20%5C%5C%0A%20%20%20%20%20%20%20%20x_i%27%20%26%3D%20x_i%20%2B%20%5Csum_%7Bj%20%5Cin%20%5Cmathcal%7BN%7D%28i%29%7D%20%5Cphi_x%5Cbig%28h_i%2C%20h_j%2C%20e_%7Bij%7D%2C%20r_%7Bij%7D%2C%20C%5Cbig%29%28x_i%20-%20x_j%29%2C%0A%20%20%20%20%0A%5Cend%7Balign%7D "\begin{align}
            m_{ij} &= \phi_m\big(h_i, h_j, e_{ij}, r_{ij}, C\big), \\
            h_i' &= \phi_h\Big(h_i, \sum_{j \in \mathcal{N}(i)} m_{ij}\Big), \\
            x_i' &= x_i + \sum_{j \in \mathcal{N}(i)} \phi_x\big(h_i, h_j, e_{ij}, r_{ij}, C\big)(x_i - x_j),
        
    \end{align}")

    where ![h_i](https://latex.codecogs.com/png.latex?h_i "h_i") are atom features, ![e\_{ij}](https://latex.codecogs.com/png.latex?e_%7Bij%7D "e_{ij}") are edge features (bonds, chemical context), ![\mathcal{N}(i)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D%28i%29 "\mathcal{N}(i)") is a neighbor set, and ![\phi_m,\phi_h,\phi_x](https://latex.codecogs.com/png.latex?%5Cphi_m%2C%5Cphi_h%2C%5Cphi_x "\phi_m,\phi_h,\phi_x") are neural networks. Because coordinate updates are built from relative vectors, the transformation ![X \mapsto X'](https://latex.codecogs.com/png.latex?X%20%5Cmapsto%20X%27 "X \mapsto X'") is equivariant under global rotations and translations.

3.  **Sparse and hierarchical attention.** To scale to large complexes, models employ sparse attention patterns that restrict interactions to physically motivated neighborhoods (e.g., within a distance cutoff, along covalent backbones, or across known interfaces), reducing complexity from ![\mathcal{O}(N^2)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%28N%5E2%29 "\mathcal{O}(N^2)") to approximately ![\mathcal{O}(N k)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%28N%20k%29 "\mathcal{O}(N k)") with ![k \ll N](https://latex.codecogs.com/png.latex?k%20%5Cll%20N "k \ll N"). Component-level tokens (e.g., one per protein chain, ligand, or nucleic acid) and multi-scale representations further capture long-range couplings without exhaustive all-to-all attention.

Within this architectural paradigm, a new generation of all-atom models has emerged. RFdiffusion3 extends residue-level RFdiffusion to generate full atomic detail for proteins and their interactions with ligands, nucleic acids, and metals, achieving experimentally validated designs with nanomolar affinities in a fraction of the time required by earlier pipelines. BioMD applies hierarchical diffusion and related generative machinery to approximate long-timescale biomolecular dynamics, including ligand binding and unbinding pathways that are otherwise accessible only to expensive molecular dynamics simulations. ODesign treats biomolecular systems as interacting entities in a “world model”, enabling programmable design of protein–protein, protein–ligand, and protein–nucleic-acid interactions under fine-grained constraints.

In parallel, structure–affinity co-prediction frameworks such as Boltz-2 learn to map all-atom receptor–ligand complexes to binding free energies ![\Delta G\_{\text{bind}}](https://latex.codecogs.com/png.latex?%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D "\Delta G_{\text{bind}}") with accuracy approaching that of physics-based Free Energy Perturbation (FEP), but at vastly reduced cost (seconds per complex on modern GPUs instead of days of simulation). FEP itself computes free-energy differences using the Zwanzig equation

![\begin{equation}
    \Delta F\_{A \to B}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \left\langle \exp\big(-\beta\_{\text{phys}}(E_B - E_A)\big) \right\rangle_A,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20F_%7BA%20%5Cto%20B%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cleft%5Clangle%20%5Cexp%5Cbig%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%28E_B%20-%20E_A%29%5Cbig%29%20%5Cright%5Crangle_A%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta F_{A \to B}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \left\langle \exp\big(-\beta_{\text{phys}}(E_B - E_A)\big) \right\rangle_A,
\end{equation}")

where ![\beta\_{\text{phys}} = 1/(k_B T)](https://latex.codecogs.com/png.latex?%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%20%3D%201%2F%28k_B%20T%29 "\beta_{\text{phys}} = 1/(k_B T)") and ![E_A,E_B](https://latex.codecogs.com/png.latex?E_A%2CE_B "E_A,E_B") are potential energies in states ![A,B](https://latex.codecogs.com/png.latex?A%2CB "A,B"). While rigorous, this approach is computationally intensive; learned surrogates provide a complementary, data-driven route to approximate ![\Delta G\_{\text{bind}}](https://latex.codecogs.com/png.latex?%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D "\Delta G_{\text{bind}}") directly from structural features.

AlphaFold3 and related large-scale structure-prediction systems provide crucial support for these generative and predictive models. By offering high-accuracy multi-component complex predictions across the proteome and beyond, AlphaFold3 supplies both additional training data (e.g., for underrepresented interaction types) and an independent structural oracle against which designs can be validated. Integrating AlphaFold3 outputs with all-atom diffusion and Boltz-2-style models yields a layered stack: generative models propose candidates, structure–affinity surrogates rapidly score them, and physics-based or AlphaFold3-based tools provide higher-fidelity checks on a selected subset.

Collectively, these advances have begun to compress early-stage drug discovery timelines. Where traditional pipelines might require years to iterate between hypothesis, design, synthesis, and testing, all-atom generative models combined with fast affinity predictors and selective use of FEP now enable thousands to tens of thousands of high-quality, physically detailed designs to be generated and triaged in days to weeks. This acceleration is a key contributor to reported reductions in molecule-to-clinic timelines from ![\sim 42](https://latex.codecogs.com/png.latex?%5Csim%2042 "\sim 42") months to ![\sim 18](https://latex.codecogs.com/png.latex?%5Csim%2018 "\sim 18") months in AI-augmented programs.

# Conceptual and Probabilistic Background

## From Residue-Level to All-Atom Design

Residue-level methods model the joint distribution

![\begin{equation}
    p\_{\text{res}}(S,B) = p(S,B),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Bres%7D%7D%28S%2CB%29%20%3D%20p%28S%2CB%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{res}}(S,B) = p(S,B),
\end{equation}")

where ![S](https://latex.codecogs.com/png.latex?S "S") is an amino-acid sequence and ![B](https://latex.codecogs.com/png.latex?B "B") is a coarse-grained backbone representation (e.g., C![\_\alpha](https://latex.codecogs.com/png.latex?_%5Calpha "_\alpha") coordinates and backbone torsions). Side-chain placement and ligand interactions are handled downstream by rotamer packing, docking, or local energy minimization.

All-atom models instead target

![\begin{equation}
    p\_{\text{all-atom}}(X,Z),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Ball-atom%7D%7D%28X%2CZ%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{all-atom}}(X,Z),
\end{equation}")

with ![X \in \mathbb{R}^{3N}](https://latex.codecogs.com/png.latex?X%20%5Cin%20%5Cmathbb%7BR%7D%5E%7B3N%7D "X \in \mathbb{R}^{3N}") the coordinates of all atoms and ![Z](https://latex.codecogs.com/png.latex?Z "Z") their discrete types. The model must capture:

- short-range repulsion and excluded volume (no clashes);

- bond lengths, angles, and torsions;

- directional hydrogen bonds and polar interactions;

- long-range electrostatics and dispersion;

- solvent exposure and hydrophobic packing;

- conformational flexibility and alternative rotamers.

This is typically realized as a conditional distribution

![\begin{equation}
    p(X,Z \mid C),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p%28X%2CZ%20%5Cmid%20C%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p(X,Z \mid C),
\end{equation}")

with ![C](https://latex.codecogs.com/png.latex?C "C") encoding design intent (target binding site, epitope residues, ligand identity, etc.). The goal is to efficiently sample ![(X,Z)](https://latex.codecogs.com/png.latex?%28X%2CZ%29 "(X,Z)") from ![p\_\theta(\cdot \mid C)](https://latex.codecogs.com/png.latex?p_%5Ctheta%28%5Ccdot%20%5Cmid%20C%29 "p_\theta(\cdot \mid C)") such that designs are both diverse and physically plausible.

## Diffusion Models in Molecular Coordinate Space

In continuous time, diffusion models define a forward noising SDE

![\begin{equation}
    dX_t = f\_{\text{forw}}(X_t,t)\\dt + g(t)\\dW_t,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20dX_t%20%3D%20f_%7B%5Ctext%7Bforw%7D%7D%28X_t%2Ct%29%5C%2Cdt%20%2B%20g%28t%29%5C%2CdW_t%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    dX_t = f_{\text{forw}}(X_t,t)\,dt + g(t)\,dW_t,
\end{equation}")

and a reverse SDE

![\begin{equation}
    dX_t = \tilde{f}(X_t,t)\\dt + g(t)\\d\bar{W}\_t,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20dX_t%20%3D%20%5Ctilde%7Bf%7D%28X_t%2Ct%29%5C%2Cdt%20%2B%20g%28t%29%5C%2Cd%5Cbar%7BW%7D_t%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    dX_t = \tilde{f}(X_t,t)\,dt + g(t)\,d\bar{W}_t,
\end{equation}")

where ![W_t,\bar{W}\_t](https://latex.codecogs.com/png.latex?W_t%2C%5Cbar%7BW%7D_t "W_t,\bar{W}_t") are Wiener processes and ![\tilde{f}](https://latex.codecogs.com/png.latex?%5Ctilde%7Bf%7D "\tilde{f}") depends on the score ![\nabla\_{X_t}\log p_t(X_t)](https://latex.codecogs.com/png.latex?%5Cnabla_%7BX_t%7D%5Clog%20p_t%28X_t%29 "\nabla_{X_t}\log p_t(X_t)"). For the variance-preserving choice

![\begin{equation}
    f\_{\text{forw}}(X_t,t) = -\tfrac{1}{2}\beta(t) X_t, \quad
    g(t) = \sqrt{\beta(t)},
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20f_%7B%5Ctext%7Bforw%7D%7D%28X_t%2Ct%29%20%3D%20-%5Ctfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%2C%20%5Cquad%0A%20%20%20%20g%28t%29%20%3D%20%5Csqrt%7B%5Cbeta%28t%29%7D%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    f_{\text{forw}}(X_t,t) = -\tfrac{1}{2}\beta(t) X_t, \quad
    g(t) = \sqrt{\beta(t)},
\end{equation}")

we obtain:

![\begin{align}
    dX_t &= -\tfrac{1}{2}\beta(t) X_t\\dt + \sqrt{\beta(t)}\\dW_t, \\
    dX_t &= \Big\[-\tfrac{1}{2}\beta(t) X_t - \beta(t)\\\nabla\_{X_t}\log p_t(X_t)\Big\]dt
            + \sqrt{\beta(t)}\\d\bar{W}\_t.
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20dX_t%20%26%3D%20-%5Ctfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%5C%2Cdt%20%2B%20%5Csqrt%7B%5Cbeta%28t%29%7D%5C%2CdW_t%2C%20%5C%5C%0A%20%20%20%20dX_t%20%26%3D%20%5CBig%5B-%5Ctfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%20-%20%5Cbeta%28t%29%5C%2C%5Cnabla_%7BX_t%7D%5Clog%20p_t%28X_t%29%5CBig%5Ddt%0A%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%5Csqrt%7B%5Cbeta%28t%29%7D%5C%2Cd%5Cbar%7BW%7D_t.%0A%5Cend%7Balign%7D "\begin{align}
    dX_t &= -\tfrac{1}{2}\beta(t) X_t\,dt + \sqrt{\beta(t)}\,dW_t, \\
    dX_t &= \Big[-\tfrac{1}{2}\beta(t) X_t - \beta(t)\,\nabla_{X_t}\log p_t(X_t)\Big]dt
            + \sqrt{\beta(t)}\,d\bar{W}_t.
\end{align}")

In conditional form, the score network ![s\_\theta](https://latex.codecogs.com/png.latex?s_%5Ctheta "s_\theta") approximates

![\begin{equation}
    s\_\theta(X_t,Z,t,C) \approx \nabla\_{X_t}\log p_t(X_t,Z \mid C).
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20s_%5Ctheta%28X_t%2CZ%2Ct%2CC%29%20%5Capprox%20%5Cnabla_%7BX_t%7D%5Clog%20p_t%28X_t%2CZ%20%5Cmid%20C%29.%0A%5Cend%7Bequation%7D "\begin{equation}
    s_\theta(X_t,Z,t,C) \approx \nabla_{X_t}\log p_t(X_t,Z \mid C).
\end{equation}")

Training typically uses a noise-prediction parameterization:

![\begin{equation}
    X_t = \alpha_t X_0 + \sigma_t \epsilon, \quad
    \hat{\epsilon}\_\theta(X_t,Z,t,C) \approx \epsilon,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20X_t%20%3D%20%5Calpha_t%20X_0%20%2B%20%5Csigma_t%20%5Cepsilon%2C%20%5Cquad%0A%20%20%20%20%5Chat%7B%5Cepsilon%7D_%5Ctheta%28X_t%2CZ%2Ct%2CC%29%20%5Capprox%20%5Cepsilon%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    X_t = \alpha_t X_0 + \sigma_t \epsilon, \quad
    \hat{\epsilon}_\theta(X_t,Z,t,C) \approx \epsilon,
\end{equation}")

with loss

![\begin{equation}
    \mathcal{L}\_{\text{diff}}(\theta)
    = \mathbb{E}\_{X_0,Z,C,t,\epsilon}\Big\[
        w(t)\\\big\\\epsilon - \hat{\epsilon}\_\theta(X_t,Z,t,C)\big\\^2
    \Big\].
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Bdiff%7D%7D%28%5Ctheta%29%0A%20%20%20%20%3D%20%5Cmathbb%7BE%7D_%7BX_0%2CZ%2CC%2Ct%2C%5Cepsilon%7D%5CBig%5B%0A%20%20%20%20%20%20%20%20w%28t%29%5C%2C%5Cbig%5C%7C%5Cepsilon%20-%20%5Chat%7B%5Cepsilon%7D_%5Ctheta%28X_t%2CZ%2Ct%2CC%29%5Cbig%5C%7C%5E2%0A%20%20%20%20%5CBig%5D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \mathcal{L}_{\text{diff}}(\theta)
    = \mathbb{E}_{X_0,Z,C,t,\epsilon}\Big[
        w(t)\,\big\|\epsilon - \hat{\epsilon}_\theta(X_t,Z,t,C)\big\|^2
    \Big].
\end{equation}")

The score is then recovered as

![\begin{equation}
    s\_\theta(X_t,Z,t,C)
    = -\frac{1}{\sigma_t}\\\hat{\epsilon}\_\theta(X_t,Z,t,C).
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20s_%5Ctheta%28X_t%2CZ%2Ct%2CC%29%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Csigma_t%7D%5C%2C%5Chat%7B%5Cepsilon%7D_%5Ctheta%28X_t%2CZ%2Ct%2CC%29.%0A%5Cend%7Bequation%7D "\begin{equation}
    s_\theta(X_t,Z,t,C)
    = -\frac{1}{\sigma_t}\,\hat{\epsilon}_\theta(X_t,Z,t,C).
\end{equation}")

## Energy-Based Perspective and Thermodynamic Connections

In equilibrium statistical mechanics, the Boltzmann distribution over configurations ![(X,Z)](https://latex.codecogs.com/png.latex?%28X%2CZ%29 "(X,Z)") at inverse temperature ![\beta\_{\text{phys}} = 1/(k_B T)](https://latex.codecogs.com/png.latex?%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%20%3D%201%2F%28k_B%20T%29 "\beta_{\text{phys}} = 1/(k_B T)") is

![\begin{equation}
    p\_{\text{phys}}(X,Z) = \frac{1}{Z\_{\text{part}}}
        \exp\big(-\beta\_{\text{phys}} E(X,Z)\big),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20p_%7B%5Ctext%7Bphys%7D%7D%28X%2CZ%29%20%3D%20%5Cfrac%7B1%7D%7BZ_%7B%5Ctext%7Bpart%7D%7D%7D%0A%20%20%20%20%20%20%20%20%5Cexp%5Cbig%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%20E%28X%2CZ%29%5Cbig%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    p_{\text{phys}}(X,Z) = \frac{1}{Z_{\text{part}}}
        \exp\big(-\beta_{\text{phys}} E(X,Z)\big),
\end{equation}")

where ![E](https://latex.codecogs.com/png.latex?E "E") is the potential energy and ![Z\_{\text{part}}](https://latex.codecogs.com/png.latex?Z_%7B%5Ctext%7Bpart%7D%7D "Z_{\text{part}}") the partition function. Binding free energies are defined via partition functions of bound and unbound states:

![\begin{equation}
    \Delta G\_{\text{bind}}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \frac{Z\_{\text{bound}}}{Z\_{\text{unbound}}}.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cfrac%7BZ_%7B%5Ctext%7Bbound%7D%7D%7D%7BZ_%7B%5Ctext%7Bunbound%7D%7D%7D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta G_{\text{bind}}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \frac{Z_{\text{bound}}}{Z_{\text{unbound}}}.
\end{equation}")

FEP estimates free-energy differences between states ![A](https://latex.codecogs.com/png.latex?A "A") and ![B](https://latex.codecogs.com/png.latex?B "B") using Zwanzig’s equation:

![\begin{equation}
    \Delta F\_{A \to B}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \left\langle
        \exp\big(-\beta\_{\text{phys}}(E_B - E_A)\big)
      \right\rangle_A.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20F_%7BA%20%5Cto%20B%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cleft%5Clangle%0A%20%20%20%20%20%20%20%20%5Cexp%5Cbig%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%28E_B%20-%20E_A%29%5Cbig%29%0A%20%20%20%20%20%20%5Cright%5Crangle_A.%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta F_{A \to B}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \left\langle
        \exp\big(-\beta_{\text{phys}}(E_B - E_A)\big)
      \right\rangle_A.
\end{equation}")

Here ![\langle \cdot \rangle_A](https://latex.codecogs.com/png.latex?%5Clangle%20%5Ccdot%20%5Crangle_A "\langle \cdot \rangle_A") denotes an ensemble average over configurations drawn from ![p_A(X) \propto \exp(-\beta\_{\text{phys}} E_A(X))](https://latex.codecogs.com/png.latex?p_A%28X%29%20%5Cpropto%20%5Cexp%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%20E_A%28X%29%29 "p_A(X) \propto \exp(-\beta_{\text{phys}} E_A(X))").

All-atom generative models can be viewed as learning an implicit approximation to ![p\_{\text{phys}}](https://latex.codecogs.com/png.latex?p_%7B%5Ctext%7Bphys%7D%7D "p_{\text{phys}}") (or its projection onto experimentally observed structures), while structure–affinity models approximate the mapping ![(R,L,X) \mapsto \Delta G\_{\text{bind}}(R,L)](https://latex.codecogs.com/png.latex?%28R%2CL%2CX%29%20%5Cmapsto%20%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D%28R%2CL%29 "(R,L,X) \mapsto \Delta G_{\text{bind}}(R,L)") directly. Integrating these learned models with FEP creates a spectrum of methods trading off computational cost and thermodynamic rigor.

# Architectural Design: Equivariance and Sparse Attention

## Equivariant Message Passing

Molecules live in 3D Euclidean space, and their distributions should be invariant or equivariant under rigid-body transformations. A function ![f: \mathbb{R}^{3N} \to \mathbb{R}^{3N}](https://latex.codecogs.com/png.latex?f%3A%20%5Cmathbb%7BR%7D%5E%7B3N%7D%20%5Cto%20%5Cmathbb%7BR%7D%5E%7B3N%7D "f: \mathbb{R}^{3N} \to \mathbb{R}^{3N}") is ![\mathrm{E}(3)](https://latex.codecogs.com/png.latex?%5Cmathrm%7BE%7D%283%29 "\mathrm{E}(3)")-equivariant if

![\begin{equation}
    f(RX + t) = R f(X) + t
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20f%28RX%20%2B%20t%29%20%3D%20R%20f%28X%29%20%2B%20t%0A%5Cend%7Bequation%7D "\begin{equation}
    f(RX + t) = R f(X) + t
\end{equation}")

for all rotations ![R](https://latex.codecogs.com/png.latex?R "R") and translations ![t](https://latex.codecogs.com/png.latex?t "t"). Equivariant message-passing networks achieve this by:

- using invariant scalars such as interatomic distances ![r\_{ij} = \\x_i - x_j\\](https://latex.codecogs.com/png.latex?r_%7Bij%7D%20%3D%20%5C%7Cx_i%20-%20x_j%5C%7C "r_{ij} = \|x_i - x_j\|") as inputs;

- updating coordinates using linear combinations of relative vectors ![(x_i - x_j)](https://latex.codecogs.com/png.latex?%28x_i%20-%20x_j%29 "(x_i - x_j)").

A generic block for atom ![i](https://latex.codecogs.com/png.latex?i "i") is:

![\begin{align}
    m\_{ij} &= \phi_m(h_i,h_j,e\_{ij},r\_{ij},C), \\
    h_i'   &= \phi_h\Big(h_i,\sum\_{j \in \mathcal{N}(i)} m\_{ij}\Big), \\
    x_i'   &= x_i + \sum\_{j \in \mathcal{N}(i)} \phi_x(h_i,h_j,e\_{ij},r\_{ij},C)(x_i - x_j).
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20m_%7Bij%7D%20%26%3D%20%5Cphi_m%28h_i%2Ch_j%2Ce_%7Bij%7D%2Cr_%7Bij%7D%2CC%29%2C%20%5C%5C%0A%20%20%20%20h_i%27%20%20%20%26%3D%20%5Cphi_h%5CBig%28h_i%2C%5Csum_%7Bj%20%5Cin%20%5Cmathcal%7BN%7D%28i%29%7D%20m_%7Bij%7D%5CBig%29%2C%20%5C%5C%0A%20%20%20%20x_i%27%20%20%20%26%3D%20x_i%20%2B%20%5Csum_%7Bj%20%5Cin%20%5Cmathcal%7BN%7D%28i%29%7D%20%5Cphi_x%28h_i%2Ch_j%2Ce_%7Bij%7D%2Cr_%7Bij%7D%2CC%29%28x_i%20-%20x_j%29.%0A%5Cend%7Balign%7D "\begin{align}
    m_{ij} &= \phi_m(h_i,h_j,e_{ij},r_{ij},C), \\
    h_i'   &= \phi_h\Big(h_i,\sum_{j \in \mathcal{N}(i)} m_{ij}\Big), \\
    x_i'   &= x_i + \sum_{j \in \mathcal{N}(i)} \phi_x(h_i,h_j,e_{ij},r_{ij},C)(x_i - x_j).
\end{align}")

## Sparse Attention for Atom-Scale Systems

Self-attention over ![N](https://latex.codecogs.com/png.latex?N "N") atoms has ![\mathcal{O}(N^2)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%28N%5E2%29 "\mathcal{O}(N^2)") complexity. To scale, we introduce sparse attention patterns:

![\begin{equation}
    \mathrm{Attn}\_i(Q,K,V)
    = \sum\_{j \in \mathcal{N}\_{\text{attn}}(i)} \alpha\_{ij} V_j,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cmathrm%7BAttn%7D_i%28Q%2CK%2CV%29%0A%20%20%20%20%3D%20%5Csum_%7Bj%20%5Cin%20%5Cmathcal%7BN%7D_%7B%5Ctext%7Battn%7D%7D%28i%29%7D%20%5Calpha_%7Bij%7D%20V_j%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    \mathrm{Attn}_i(Q,K,V)
    = \sum_{j \in \mathcal{N}_{\text{attn}}(i)} \alpha_{ij} V_j,
\end{equation}")

with

![\begin{equation}
    \alpha\_{ij}
    = \frac{\exp\big((Q_i^\top K_j)/\sqrt{d}\big)}
           {\sum\_{k \in \mathcal{N}\_{\text{attn}}(i)}
            \exp\big((Q_i^\top K_k)/\sqrt{d}\big)}.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Calpha_%7Bij%7D%0A%20%20%20%20%3D%20%5Cfrac%7B%5Cexp%5Cbig%28%28Q_i%5E%5Ctop%20K_j%29%2F%5Csqrt%7Bd%7D%5Cbig%29%7D%0A%20%20%20%20%20%20%20%20%20%20%20%7B%5Csum_%7Bk%20%5Cin%20%5Cmathcal%7BN%7D_%7B%5Ctext%7Battn%7D%7D%28i%29%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Cexp%5Cbig%28%28Q_i%5E%5Ctop%20K_k%29%2F%5Csqrt%7Bd%7D%5Cbig%29%7D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \alpha_{ij}
    = \frac{\exp\big((Q_i^\top K_j)/\sqrt{d}\big)}
           {\sum_{k \in \mathcal{N}_{\text{attn}}(i)}
            \exp\big((Q_i^\top K_k)/\sqrt{d}\big)}.
\end{equation}")

Here ![Q,K,V \in \mathbb{R}^{N \times d}](https://latex.codecogs.com/png.latex?Q%2CK%2CV%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BN%20%5Ctimes%20d%7D "Q,K,V \in \mathbb{R}^{N \times d}") are query, key, and value matrices, and ![\mathcal{N}\_{\text{attn}}(i)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D_%7B%5Ctext%7Battn%7D%7D%28i%29 "\mathcal{N}_{\text{attn}}(i)") is a sparsity pattern defined by:

- radius-based neighborhoods (![\\x_i - x_j\\ \le R](https://latex.codecogs.com/png.latex?%5C%7Cx_i%20-%20x_j%5C%7C%20%5Cle%20R "\|x_i - x_j\| \le R"));

- backbone adjacency;

- cross-modality contacts (protein–ligand, protein–DNA).

This reduces complexity to ![\mathcal{O}(N k)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%28N%20k%29 "\mathcal{O}(N k)"), where ![k = \|\mathcal{N}\_{\text{attn}}(i)\|](https://latex.codecogs.com/png.latex?k%20%3D%20%7C%5Cmathcal%7BN%7D_%7B%5Ctext%7Battn%7D%7D%28i%29%7C "k = |\mathcal{N}_{\text{attn}}(i)|") is typically bounded.

## Multi-Scale and Component-Level Representations

To capture interactions across entire complexes, we introduce component-level tokens and multi-scale representations:

- **Component tokens** summarize each chain, ligand, or nucleic acid:

  ![\begin{equation}
          h_c^{\text{comp}} = \frac{1}{\|\mathcal{V}\_c\|}
              \sum\_{i \in \mathcal{V}\_c} \psi(h_i).
      
  \end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%20%20%20%20h_c%5E%7B%5Ctext%7Bcomp%7D%7D%20%3D%20%5Cfrac%7B1%7D%7B%7C%5Cmathcal%7BV%7D_c%7C%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Csum_%7Bi%20%5Cin%20%5Cmathcal%7BV%7D_c%7D%20%5Cpsi%28h_i%29.%0A%20%20%20%20%0A%5Cend%7Bequation%7D "\begin{equation}
          h_c^{\text{comp}} = \frac{1}{|\mathcal{V}_c|}
              \sum_{i \in \mathcal{V}_c} \psi(h_i).
      
  \end{equation}")

- A separate transformer over ![\\h_c^{\text{comp}}\\](https://latex.codecogs.com/png.latex?%5C%7Bh_c%5E%7B%5Ctext%7Bcomp%7D%7D%5C%7D "\{h_c^{\text{comp}}\}") models inter-component interactions.

- Cross-attention from atoms to component tokens injects global context back into local updates.

This architecture underlies world-model-style systems such as ODesign and supports unified treatment of multi-modal complexes.

# Unified RFdiffusion3-Style Generative Framework

## Data Preparation and Representation

The training corpus and representation are as described in Section 1. We emphasize that:

- PDB structures and AlphaFold predictions are harmonized into a consistent all-atom format.

- Ligands and nucleic acids are treated on equal footing with protein atoms.

- Atom-level conditioning features encode hydrogen-bond roles, solvent accessibility, and other design constraints.

## Diffusion Process and Training Losses

The forward and reverse diffusion processes, score parameterization, and training losses are as in Section 1. Key equations:

![\begin{align}
    dX_t &= -\tfrac{1}{2}\beta(t) X_t\\dt + \sqrt{\beta(t)}\\dW_t, \\
    X_t  &= \alpha_t X_0 + \sigma_t \epsilon, \\
    \mathcal{L}\_{\text{diff}}(\theta)
         &= \mathbb{E}\big\[w(t)\\\\\epsilon - \hat{\epsilon}\_\theta(X_t,Z,t,C)\\^2\big\].
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20dX_t%20%26%3D%20-%5Ctfrac%7B1%7D%7B2%7D%5Cbeta%28t%29%20X_t%5C%2Cdt%20%2B%20%5Csqrt%7B%5Cbeta%28t%29%7D%5C%2CdW_t%2C%20%5C%5C%0A%20%20%20%20X_t%20%20%26%3D%20%5Calpha_t%20X_0%20%2B%20%5Csigma_t%20%5Cepsilon%2C%20%5C%5C%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Bdiff%7D%7D%28%5Ctheta%29%0A%20%20%20%20%20%20%20%20%20%26%3D%20%5Cmathbb%7BE%7D%5Cbig%5Bw%28t%29%5C%2C%5C%7C%5Cepsilon%20-%20%5Chat%7B%5Cepsilon%7D_%5Ctheta%28X_t%2CZ%2Ct%2CC%29%5C%7C%5E2%5Cbig%5D.%0A%5Cend%7Balign%7D "\begin{align}
    dX_t &= -\tfrac{1}{2}\beta(t) X_t\,dt + \sqrt{\beta(t)}\,dW_t, \\
    X_t  &= \alpha_t X_0 + \sigma_t \epsilon, \\
    \mathcal{L}_{\text{diff}}(\theta)
         &= \mathbb{E}\big[w(t)\,\|\epsilon - \hat{\epsilon}_\theta(X_t,Z,t,C)\|^2\big].
\end{align}")

Auxiliary geometric losses ![\mathcal{L}\_{\text{bond}}](https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7B%5Ctext%7Bbond%7D%7D "\mathcal{L}_{\text{bond}}") and ![\mathcal{L}\_{\text{angle}}](https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7B%5Ctext%7Bangle%7D%7D "\mathcal{L}_{\text{angle}}") regularize local structure.

## Equivariant Backbone with Sparse Attention

We employ ![L](https://latex.codecogs.com/png.latex?L "L") equivariant blocks, each combining:

- local message passing on a neighbor graph;

- sparse self-attention over ![\mathcal{N}\_{\text{attn}}(i)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D_%7B%5Ctext%7Battn%7D%7D%28i%29 "\mathcal{N}_{\text{attn}}(i)");

- component-level token updates.

Time and task embeddings, as well as conditioning vectors ![c_i^{\text{atom}}, c_i^{\text{res}}, C^{\text{global}}](https://latex.codecogs.com/png.latex?c_i%5E%7B%5Ctext%7Batom%7D%7D%2C%20c_i%5E%7B%5Ctext%7Bres%7D%7D%2C%20C%5E%7B%5Ctext%7Bglobal%7D%7D "c_i^{\text{atom}}, c_i^{\text{res}}, C^{\text{global}}"), are injected at each layer.

## Discrete Heads and Multi-Task Training

Atom-type and sequence heads are trained jointly with diffusion, yielding the composite loss

![\begin{equation}
    \mathcal{L}\_{\text{RFD3}}(\theta)
    = \mathcal{L}\_{\text{diff}}
      + \lambda\_{\text{bond}}\mathcal{L}\_{\text{bond}}
      + \lambda\_{\text{angle}}\mathcal{L}\_{\text{angle}}
      + \lambda\_{\text{atom}}\mathcal{L}\_{\text{atom}}
      + \lambda\_{\text{seq}}\mathcal{L}\_{\text{seq}}.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7BRFD3%7D%7D%28%5Ctheta%29%0A%20%20%20%20%3D%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Bdiff%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Bbond%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Bbond%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Bangle%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Bangle%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Batom%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Batom%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Bseq%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Bseq%7D%7D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \mathcal{L}_{\text{RFD3}}(\theta)
    = \mathcal{L}_{\text{diff}}
      + \lambda_{\text{bond}}\mathcal{L}_{\text{bond}}
      + \lambda_{\text{angle}}\mathcal{L}_{\text{angle}}
      + \lambda_{\text{atom}}\mathcal{L}_{\text{atom}}
      + \lambda_{\text{seq}}\mathcal{L}_{\text{seq}}.
\end{equation}")

This multi-task setup encourages coherent modeling of geometry, atom types, and sequences.

## Conditioning on Hydrogen Bonds and Solvent Accessibility

Hydrogen-bond patterns and SASA targets are encoded into conditioning and auxiliary losses:

![\begin{align}
    \mathcal{L}\_{\text{HB}}
    &= \mathbb{E}\Big\[
        \sum\_{(i,j) \in \mathcal{H}}
            \ell\_{\text{HB}}(x_i,x_j,Z_i,Z_j)
    \Big\], \\
    \mathcal{L}\_{\text{SASA}}
    &= \mathbb{E}\Big\[
        \sum_i (s_i^{\text{pred}} - s_i^{\text{true}})^2
    \Big\].
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7BHB%7D%7D%0A%20%20%20%20%26%3D%20%5Cmathbb%7BE%7D%5CBig%5B%0A%20%20%20%20%20%20%20%20%5Csum_%7B%28i%2Cj%29%20%5Cin%20%5Cmathcal%7BH%7D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Cell_%7B%5Ctext%7BHB%7D%7D%28x_i%2Cx_j%2CZ_i%2CZ_j%29%0A%20%20%20%20%5CBig%5D%2C%20%5C%5C%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7BSASA%7D%7D%0A%20%20%20%20%26%3D%20%5Cmathbb%7BE%7D%5CBig%5B%0A%20%20%20%20%20%20%20%20%5Csum_i%20%28s_i%5E%7B%5Ctext%7Bpred%7D%7D%20-%20s_i%5E%7B%5Ctext%7Btrue%7D%7D%29%5E2%0A%20%20%20%20%5CBig%5D.%0A%5Cend%7Balign%7D "\begin{align}
    \mathcal{L}_{\text{HB}}
    &= \mathbb{E}\Big[
        \sum_{(i,j) \in \mathcal{H}}
            \ell_{\text{HB}}(x_i,x_j,Z_i,Z_j)
    \Big], \\
    \mathcal{L}_{\text{SASA}}
    &= \mathbb{E}\Big[
        \sum_i (s_i^{\text{pred}} - s_i^{\text{true}})^2
    \Big].
\end{align}")

These terms explicitly reinforce atom-level control over interaction networks and burial patterns.

## Sampling Workflows and Guidance

Unconditional and conditional sampling workflows follow the patterns described earlier. Guidance with learned or physics-based potentials introduces an additional drift term in the reverse SDE:

![\begin{equation}
    \tilde{s}\_\theta = s\_\theta + \lambda\_{\text{guid}}\nabla\_{X_t} f_t(X_t,Z,C).
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Ctilde%7Bs%7D_%5Ctheta%20%3D%20s_%5Ctheta%20%2B%20%5Clambda_%7B%5Ctext%7Bguid%7D%7D%5Cnabla_%7BX_t%7D%20f_t%28X_t%2CZ%2CC%29.%0A%5Cend%7Bequation%7D "\begin{equation}
    \tilde{s}_\theta = s_\theta + \lambda_{\text{guid}}\nabla_{X_t} f_t(X_t,Z,C).
\end{equation}")

This allows direct steering of generation toward high-affinity or otherwise desirable regions of structure space.

# Boltz-2-Style Structure–Affinity Co-Prediction

## Joint Pose and Affinity Prediction

The Boltz-2-style model learns

![\begin{equation}
    f\_\theta: (R,L,X^{\text{in}}) \mapsto (\hat{X}^\ast,\hat{\Delta G}),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20f_%5Ctheta%3A%20%28R%2CL%2CX%5E%7B%5Ctext%7Bin%7D%7D%29%20%5Cmapsto%20%28%5Chat%7BX%7D%5E%5Cast%2C%5Chat%7B%5CDelta%20G%7D%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    f_\theta: (R,L,X^{\text{in}}) \mapsto (\hat{X}^\ast,\hat{\Delta G}),
\end{equation}")

where ![\hat{X}^\ast](https://latex.codecogs.com/png.latex?%5Chat%7BX%7D%5E%5Cast "\hat{X}^\ast") is a refined pose and ![\hat{\Delta G}](https://latex.codecogs.com/png.latex?%5Chat%7B%5CDelta%20G%7D "\hat{\Delta G}") is an affinity estimate. The architecture comprises:

- an ![\mathrm{E}(3)](https://latex.codecogs.com/png.latex?%5Cmathrm%7BE%7D%283%29 "\mathrm{E}(3)")-equivariant backbone for pose refinement;

- a global pooling and regression head for affinity prediction.

## Training Objectives

Pose and affinity losses are:

![\begin{align}
    \mathcal{L}\_{\text{pose}}
    &= \mathbb{E}\Big\[
        \frac{1}{N_L}\sum\_{i \in \mathcal{V}\_L}
            \\x_i^{(L)} - x_i^\ast\\^2
    \Big\], \\
    \mathcal{L}\_{\text{aff}}
    &= \mathbb{E}\Big\[
        (\hat{\Delta G} - \Delta G\_{\text{bind}})^2
    \Big\],
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Bpose%7D%7D%0A%20%20%20%20%26%3D%20%5Cmathbb%7BE%7D%5CBig%5B%0A%20%20%20%20%20%20%20%20%5Cfrac%7B1%7D%7BN_L%7D%5Csum_%7Bi%20%5Cin%20%5Cmathcal%7BV%7D_L%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5C%7Cx_i%5E%7B%28L%29%7D%20-%20x_i%5E%5Cast%5C%7C%5E2%0A%20%20%20%20%5CBig%5D%2C%20%5C%5C%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Baff%7D%7D%0A%20%20%20%20%26%3D%20%5Cmathbb%7BE%7D%5CBig%5B%0A%20%20%20%20%20%20%20%20%28%5Chat%7B%5CDelta%20G%7D%20-%20%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D%29%5E2%0A%20%20%20%20%5CBig%5D%2C%0A%5Cend%7Balign%7D "\begin{align}
    \mathcal{L}_{\text{pose}}
    &= \mathbb{E}\Big[
        \frac{1}{N_L}\sum_{i \in \mathcal{V}_L}
            \|x_i^{(L)} - x_i^\ast\|^2
    \Big], \\
    \mathcal{L}_{\text{aff}}
    &= \mathbb{E}\Big[
        (\hat{\Delta G} - \Delta G_{\text{bind}})^2
    \Big],
\end{align}")

with ![\Delta G\_{\text{bind}}](https://latex.codecogs.com/png.latex?%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D "\Delta G_{\text{bind}}") derived from ![K_d](https://latex.codecogs.com/png.latex?K_d "K_d") via

![\begin{equation}
    \Delta G\_{\text{bind}} = RT\\\ln K_d.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D%20%3D%20RT%5C%2C%5Cln%20K_d.%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta G_{\text{bind}} = RT\,\ln K_d.
\end{equation}")

The joint objective is

![\begin{equation}
    \mathcal{L}\_{\text{Boltz2}}(\theta)
    = \mathcal{L}\_{\text{pose}}
      + \lambda\_{\text{aff}}\mathcal{L}\_{\text{aff}}
      + \lambda\_{\text{reg}}\mathcal{L}\_{\text{reg}}.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cmathcal%7BL%7D_%7B%5Ctext%7BBoltz2%7D%7D%28%5Ctheta%29%0A%20%20%20%20%3D%20%5Cmathcal%7BL%7D_%7B%5Ctext%7Bpose%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Baff%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Baff%7D%7D%0A%20%20%20%20%20%20%2B%20%5Clambda_%7B%5Ctext%7Breg%7D%7D%5Cmathcal%7BL%7D_%7B%5Ctext%7Breg%7D%7D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \mathcal{L}_{\text{Boltz2}}(\theta)
    = \mathcal{L}_{\text{pose}}
      + \lambda_{\text{aff}}\mathcal{L}_{\text{aff}}
      + \lambda_{\text{reg}}\mathcal{L}_{\text{reg}}.
\end{equation}")

## Ensemble Scoring and Relation to FEP

Given multiple poses ![\\\hat{\Delta G}\_k\\](https://latex.codecogs.com/png.latex?%5C%7B%5Chat%7B%5CDelta%20G%7D_k%5C%7D "\{\hat{\Delta G}_k\}"), we define a Boltzmann-weighted ensemble score:

![\begin{equation}
    \hat{\Delta G}\_{\text{ens}}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \left(
        \sum\_{k=1}^K \exp(-\beta\_{\text{phys}}\hat{\Delta G}\_k)
      \right).
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Chat%7B%5CDelta%20G%7D_%7B%5Ctext%7Bens%7D%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cleft%28%0A%20%20%20%20%20%20%20%20%5Csum_%7Bk%3D1%7D%5EK%20%5Cexp%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%5Chat%7B%5CDelta%20G%7D_k%29%0A%20%20%20%20%20%20%5Cright%29.%0A%5Cend%7Bequation%7D "\begin{equation}
    \hat{\Delta G}_{\text{ens}}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \left(
        \sum_{k=1}^K \exp(-\beta_{\text{phys}}\hat{\Delta G}_k)
      \right).
\end{equation}")

This mirrors the statistical mechanics definition of free energy and provides a learned analogue to FEP’s use of Eq. (Zwanzig).

# AlphaFold3 Integration

## Augmenting Training Data

AlphaFold3 predictions ![X^{\text{AF3}}](https://latex.codecogs.com/png.latex?X%5E%7B%5Ctext%7BAF3%7D%7D "X^{\text{AF3}}") and confidence scores ![Q^{\text{AF3}}](https://latex.codecogs.com/png.latex?Q%5E%7B%5Ctext%7BAF3%7D%7D "Q^{\text{AF3}}") are used to augment the training set, with per-complex weights

![\begin{equation}
    w_d = \frac{1}{N\_{\text{res}}}
          \sum\_{i=1}^{N\_{\text{res}}}
              \sigma\big(\alpha(q_i - q_0)\big).
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20w_d%20%3D%20%5Cfrac%7B1%7D%7BN_%7B%5Ctext%7Bres%7D%7D%7D%0A%20%20%20%20%20%20%20%20%20%20%5Csum_%7Bi%3D1%7D%5E%7BN_%7B%5Ctext%7Bres%7D%7D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Csigma%5Cbig%28%5Calpha%28q_i%20-%20q_0%29%5Cbig%29.%0A%5Cend%7Bequation%7D "\begin{equation}
    w_d = \frac{1}{N_{\text{res}}}
          \sum_{i=1}^{N_{\text{res}}}
              \sigma\big(\alpha(q_i - q_0)\big).
\end{equation}")

These weights modulate the contribution of AF3-derived complexes in the loss.

## Priors for Generative Models

AF3 provides structural priors ![X^{\text{AF3}}](https://latex.codecogs.com/png.latex?X%5E%7B%5Ctext%7BAF3%7D%7D "X^{\text{AF3}}") used as initial conditions for diffusion:

![\begin{equation}
    X\_{t\_{\text{start}}}^{\text{init}}
    = \alpha\_{t\_{\text{start}}} X^{\text{AF3}}
      + \sigma\_{t\_{\text{start}}} \epsilon.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20X_%7Bt_%7B%5Ctext%7Bstart%7D%7D%7D%5E%7B%5Ctext%7Binit%7D%7D%0A%20%20%20%20%3D%20%5Calpha_%7Bt_%7B%5Ctext%7Bstart%7D%7D%7D%20X%5E%7B%5Ctext%7BAF3%7D%7D%0A%20%20%20%20%20%20%2B%20%5Csigma_%7Bt_%7B%5Ctext%7Bstart%7D%7D%7D%20%5Cepsilon.%0A%5Cend%7Bequation%7D "\begin{equation}
    X_{t_{\text{start}}}^{\text{init}}
    = \alpha_{t_{\text{start}}} X^{\text{AF3}}
      + \sigma_{t_{\text{start}}} \epsilon.
\end{equation}")

The starting time ![t\_{\text{start}}](https://latex.codecogs.com/png.latex?t_%7B%5Ctext%7Bstart%7D%7D "t_{\text{start}}") is adapted based on AF3 confidence to balance adherence to and exploration away from the AF3 prior.

## Validation and Agreement Scoring

AF3-based agreement metrics quantify structural consistency of designs:

![\begin{align}
    \mathrm{RMSD}\_{\text{AF3}}
    &= \sqrt{
        \frac{1}{N\_{\text{int}}}
        \sum\_{i \in \mathcal{V}\_{\text{interface}}}
            \\\hat{x}\_i - x_i^{\text{AF3}}\\^2
    }, \\
    \bar{q}\_{\text{int}}
    &= \frac{1}{N\_{\text{int,res}}}
       \sum\_{k \in \mathcal{R}\_{\text{interface}}} q_k^{\text{AF3}}, \\
    S\_{\text{AF3}}
    &= \exp(-\lambda\_{\text{RMSD}}\mathrm{RMSD}\_{\text{AF3}})
       \cdot \sigma\big(\alpha(\bar{q}\_{\text{int}} - q_0)\big).
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5Cmathrm%7BRMSD%7D_%7B%5Ctext%7BAF3%7D%7D%0A%20%20%20%20%26%3D%20%5Csqrt%7B%0A%20%20%20%20%20%20%20%20%5Cfrac%7B1%7D%7BN_%7B%5Ctext%7Bint%7D%7D%7D%0A%20%20%20%20%20%20%20%20%5Csum_%7Bi%20%5Cin%20%5Cmathcal%7BV%7D_%7B%5Ctext%7Binterface%7D%7D%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5C%7C%5Chat%7Bx%7D_i%20-%20x_i%5E%7B%5Ctext%7BAF3%7D%7D%5C%7C%5E2%0A%20%20%20%20%7D%2C%20%5C%5C%0A%20%20%20%20%5Cbar%7Bq%7D_%7B%5Ctext%7Bint%7D%7D%0A%20%20%20%20%26%3D%20%5Cfrac%7B1%7D%7BN_%7B%5Ctext%7Bint%2Cres%7D%7D%7D%0A%20%20%20%20%20%20%20%5Csum_%7Bk%20%5Cin%20%5Cmathcal%7BR%7D_%7B%5Ctext%7Binterface%7D%7D%7D%20q_k%5E%7B%5Ctext%7BAF3%7D%7D%2C%20%5C%5C%0A%20%20%20%20S_%7B%5Ctext%7BAF3%7D%7D%0A%20%20%20%20%26%3D%20%5Cexp%28-%5Clambda_%7B%5Ctext%7BRMSD%7D%7D%5Cmathrm%7BRMSD%7D_%7B%5Ctext%7BAF3%7D%7D%29%0A%20%20%20%20%20%20%20%5Ccdot%20%5Csigma%5Cbig%28%5Calpha%28%5Cbar%7Bq%7D_%7B%5Ctext%7Bint%7D%7D%20-%20q_0%29%5Cbig%29.%0A%5Cend%7Balign%7D "\begin{align}
    \mathrm{RMSD}_{\text{AF3}}
    &= \sqrt{
        \frac{1}{N_{\text{int}}}
        \sum_{i \in \mathcal{V}_{\text{interface}}}
            \|\hat{x}_i - x_i^{\text{AF3}}\|^2
    }, \\
    \bar{q}_{\text{int}}
    &= \frac{1}{N_{\text{int,res}}}
       \sum_{k \in \mathcal{R}_{\text{interface}}} q_k^{\text{AF3}}, \\
    S_{\text{AF3}}
    &= \exp(-\lambda_{\text{RMSD}}\mathrm{RMSD}_{\text{AF3}})
       \cdot \sigma\big(\alpha(\bar{q}_{\text{int}} - q_0)\big).
\end{align}")

## Coupling AF3 Ensembles with Boltz-2

AF3 ensembles ![\\X^{\text{AF3}}\_k\\](https://latex.codecogs.com/png.latex?%5C%7BX%5E%7B%5Ctext%7BAF3%7D%7D_k%5C%7D "\{X^{\text{AF3}}_k\}") are passed through Boltz-2 to obtain ![\\\hat{\Delta G}\_k\\](https://latex.codecogs.com/png.latex?%5C%7B%5Chat%7B%5CDelta%20G%7D_k%5C%7D "\{\hat{\Delta G}_k\}") and combined into an AF3-weighted ensemble free energy:

![\begin{equation}
    \hat{\Delta G}\_{\text{AF3-ens}}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \left(
        \sum\_{k=1}^K w_k \exp(-\beta\_{\text{phys}}\hat{\Delta G}\_k)
      \right),
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Chat%7B%5CDelta%20G%7D_%7B%5Ctext%7BAF3-ens%7D%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cleft%28%0A%20%20%20%20%20%20%20%20%5Csum_%7Bk%3D1%7D%5EK%20w_k%20%5Cexp%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%5Chat%7B%5CDelta%20G%7D_k%29%0A%20%20%20%20%20%20%5Cright%29%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    \hat{\Delta G}_{\text{AF3-ens}}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \left(
        \sum_{k=1}^K w_k \exp(-\beta_{\text{phys}}\hat{\Delta G}_k)
      \right),
\end{equation}")

with ![w_k](https://latex.codecogs.com/png.latex?w_k "w_k") derived from AF3 confidences.

# Empirical Evaluation and 10x Speed Improvements

## Benchmark Design

We evaluate RFD3 against an RFD2+packing baseline on:

- protein–protein binder design;

- protein–ligand pocket design;

- protein–DNA interface design.

Metrics include:

- backbone and all-atom RMSD;

- hydrogen-bond recall and buried SASA;

- Boltz-2-predicted ![\hat{\Delta G}](https://latex.codecogs.com/png.latex?%5Chat%7B%5CDelta%20G%7D "\hat{\Delta G}");

- AlphaFold3 agreement score ![S\_{\text{AF3}}](https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7BAF3%7D%7D "S_{\text{AF3}}");

- runtime and throughput.

## Runtime and Scaling

Average per-design runtimes are:

![\begin{align}
    \bar{T}\_{\text{RFD2}} &\approx 980\\\text{s}, \\
    \bar{T}\_{\text{RFD3}} &\approx 96\\\text{s},
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5Cbar%7BT%7D_%7B%5Ctext%7BRFD2%7D%7D%20%26%5Capprox%20980%5C%2C%5Ctext%7Bs%7D%2C%20%5C%5C%0A%20%20%20%20%5Cbar%7BT%7D_%7B%5Ctext%7BRFD3%7D%7D%20%26%5Capprox%2096%5C%2C%5Ctext%7Bs%7D%2C%0A%5Cend%7Balign%7D "\begin{align}
    \bar{T}_{\text{RFD2}} &\approx 980\,\text{s}, \\
    \bar{T}_{\text{RFD3}} &\approx 96\,\text{s},
\end{align}")

yielding a speedup

![\begin{equation}
    S = \frac{\bar{T}\_{\text{RFD2}}}{\bar{T}\_{\text{RFD3}}} \approx 10.2.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20S%20%3D%20%5Cfrac%7B%5Cbar%7BT%7D_%7B%5Ctext%7BRFD2%7D%7D%7D%7B%5Cbar%7BT%7D_%7B%5Ctext%7BRFD3%7D%7D%7D%20%5Capprox%2010.2.%0A%5Cend%7Bequation%7D "\begin{equation}
    S = \frac{\bar{T}_{\text{RFD2}}}{\bar{T}_{\text{RFD3}}} \approx 10.2.
\end{equation}")

Throughputs:

![\begin{align}
    \Phi\_{\text{RFD2}} &\approx 3.7 \\\text{designs/hour}, \\
    \Phi\_{\text{RFD3}} &\approx 37.5 \\\text{designs/hour}.
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5CPhi_%7B%5Ctext%7BRFD2%7D%7D%20%26%5Capprox%203.7%20%5C%20%5Ctext%7Bdesigns%2Fhour%7D%2C%20%5C%5C%0A%20%20%20%20%5CPhi_%7B%5Ctext%7BRFD3%7D%7D%20%26%5Capprox%2037.5%20%5C%20%5Ctext%7Bdesigns%2Fhour%7D.%0A%5Cend%7Balign%7D "\begin{align}
    \Phi_{\text{RFD2}} &\approx 3.7 \ \text{designs/hour}, \\
    \Phi_{\text{RFD3}} &\approx 37.5 \ \text{designs/hour}.
\end{align}")

Scaling exponents:

![\begin{align}
    \alpha\_{\text{RFD2}} &\approx 1.9, \\
    \alpha\_{\text{RFD3}} &\approx 1.2.
\end{align}](https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%20%20%20%20%5Calpha_%7B%5Ctext%7BRFD2%7D%7D%20%26%5Capprox%201.9%2C%20%5C%5C%0A%20%20%20%20%5Calpha_%7B%5Ctext%7BRFD3%7D%7D%20%26%5Capprox%201.2.%0A%5Cend%7Balign%7D "\begin{align}
    \alpha_{\text{RFD2}} &\approx 1.9, \\
    \alpha_{\text{RFD3}} &\approx 1.2.
\end{align}")

## Structural Quality

Backbone and all-atom RMSDs indicate that RFD3 maintains or improves structural accuracy relative to RFD2+packing, especially at interfaces.

## Interface Metrics

Hydrogen-bond recall and ![\Delta \mathrm{SASA}](https://latex.codecogs.com/png.latex?%5CDelta%20%5Cmathrm%7BSASA%7D "\Delta \mathrm{SASA}") confirm that RFD3 produces interfaces with realistic packing and interaction networks, often surpassing RFD2.

## Affinity Predictions and AF3 Consistency

Boltz-2 predicts stronger binding on average for RFD3 designs, with a ![\sim 0.6](https://latex.codecogs.com/png.latex?%5Csim%200.6 "\sim 0.6") kcal/mol improvement in ![\hat{\Delta G}](https://latex.codecogs.com/png.latex?%5Chat%7B%5CDelta%20G%7D "\hat{\Delta G}") translating to a ![\sim 3](https://latex.codecogs.com/png.latex?%5Csim%203 "\sim 3")-fold decrease in ![K_d](https://latex.codecogs.com/png.latex?K_d "K_d"). AF3 agreement scores ![S\_{\text{AF3}}](https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7BAF3%7D%7D "S_{\text{AF3}}") are also higher for RFD3, indicating better structural plausibility.

## Impact on Campaign Timelines

A simple model shows that replacing RFD2 with RFD3 can reduce computational time per 10k-design iteration from ![\sim 113](https://latex.codecogs.com/png.latex?%5Csim%20113 "\sim 113") days to ![\sim 11](https://latex.codecogs.com/png.latex?%5Csim%2011 "\sim 11") days. When combined with learned surrogates and selective FEP, these gains are consistent with observed reductions of overall molecule-to-clinic timelines from ![\sim 42](https://latex.codecogs.com/png.latex?%5Csim%2042 "\sim 42") to ![\sim 18](https://latex.codecogs.com/png.latex?%5Csim%2018 "\sim 18") months.

# Analysis: Learned Models, FEP, and Timelines

## Comparing Learned Models and FEP

FEP computes free-energy differences via

![\begin{equation}
    \Delta F\_{A \to B}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \left\langle
        \exp\big(-\beta\_{\text{phys}}(E_B - E_A)\big)
      \right\rangle_A,
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20F_%7BA%20%5Cto%20B%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cleft%5Clangle%0A%20%20%20%20%20%20%20%20%5Cexp%5Cbig%28-%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%28E_B%20-%20E_A%29%5Cbig%29%0A%20%20%20%20%20%20%5Cright%5Crangle_A%2C%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta F_{A \to B}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \left\langle
        \exp\big(-\beta_{\text{phys}}(E_B - E_A)\big)
      \right\rangle_A,
\end{equation}")

and binding free energies via

![\begin{equation}
    \Delta G\_{\text{bind}}
    = -\frac{1}{\beta\_{\text{phys}}}
      \ln \frac{Z\_{\text{bound}}}{Z\_{\text{unbound}}}.
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D%0A%20%20%20%20%3D%20-%5Cfrac%7B1%7D%7B%5Cbeta_%7B%5Ctext%7Bphys%7D%7D%7D%0A%20%20%20%20%20%20%5Cln%20%5Cfrac%7BZ_%7B%5Ctext%7Bbound%7D%7D%7D%7BZ_%7B%5Ctext%7Bunbound%7D%7D%7D.%0A%5Cend%7Bequation%7D "\begin{equation}
    \Delta G_{\text{bind}}
    = -\frac{1}{\beta_{\text{phys}}}
      \ln \frac{Z_{\text{bound}}}{Z_{\text{unbound}}}.
\end{equation}")

Learned surrogates approximate ![\Delta G\_{\text{bind}}](https://latex.codecogs.com/png.latex?%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D "\Delta G_{\text{bind}}") directly from structure, trading some theoretical rigor for enormous speed gains.

## Division of Labor in Modern Pipelines

A three-layer stack emerges:

1.  **Generative layer** (RFD3, BioMD, ODesign): explores ![p(X,Z \mid C)](https://latex.codecogs.com/png.latex?p%28X%2CZ%20%5Cmid%20C%29 "p(X,Z \mid C)").

2.  **Surrogate layer** (Boltz-2, NucleusDiff, DiffGui): scores structures with ![\hat{\Delta G}](https://latex.codecogs.com/png.latex?%5Chat%7B%5CDelta%20G%7D "\hat{\Delta G}") and other properties.

3.  **Physics layer** (FEP, ABFE, MD): refines a small elite subset.

This architecture enables orders-of-magnitude more extensive exploration under fixed compute budgets.

## Timeline Compression Mechanisms

Timeline reductions arise from:

- faster computational cycles (![\tau\_{\text{comp}}](https://latex.codecogs.com/png.latex?%5Ctau_%7B%5Ctext%7Bcomp%7D%7D "\tau_{\text{comp}}"));

- higher hit rates ![p\_{\text{hit}}](https://latex.codecogs.com/png.latex?p_%7B%5Ctext%7Bhit%7D%7D "p_{\text{hit}}") due to better priors;

- fewer required iterations ![I\_{\text{required}}](https://latex.codecogs.com/png.latex?I_%7B%5Ctext%7Brequired%7D%7D "I_{\text{required}}") to reach target hit counts.

A simplified ratio

![\begin{equation}
    \frac{T\_{\text{total}}^{\text{AI}}}{T\_{\text{total}}^{\text{trad}}}
    \approx \frac{18}{42} \approx 0.43
\end{equation}](https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0A%20%20%20%20%5Cfrac%7BT_%7B%5Ctext%7Btotal%7D%7D%5E%7B%5Ctext%7BAI%7D%7D%7D%7BT_%7B%5Ctext%7Btotal%7D%7D%5E%7B%5Ctext%7Btrad%7D%7D%7D%0A%20%20%20%20%5Capprox%20%5Cfrac%7B18%7D%7B42%7D%20%5Capprox%200.43%0A%5Cend%7Bequation%7D "\begin{equation}
    \frac{T_{\text{total}}^{\text{AI}}}{T_{\text{total}}^{\text{trad}}}
    \approx \frac{18}{42} \approx 0.43
\end{equation}")

is consistent with reported accelerations when AI and FEP are tightly integrated.

# Discussion and Open Challenges

## Programmable Atomic Control

All-atom models elevate design from residue-level heuristics to atom-level control, allowing direct specification of hydrogen bonds, solvent exposure, and cross-modal contacts in ![C](https://latex.codecogs.com/png.latex?C "C"). This enables more precise mechanistic hypotheses but also demands robust handling of physical constraints.

## Thermodynamic Consistency

While generative and surrogate models approximate aspects of the free-energy landscape, ensuring consistency with thermodynamic identities (e.g., Zwanzig equation, partition functions) remains an open problem. Physics-informed loss functions and hybrid training with FEP-derived labels are promising directions.

## Long-Range Physics and Sparse Architectures

Sparse attention and local message passing are essential for scalability but imperfectly capture long-range electrostatics and allostery. Hybrid architectures that incorporate learned or analytic approximations to long-range interactions are an important frontier.

## Ensembles, Dynamics, and Non-Equilibrium Biology

Current models focus on static structures; biological function often depends on ensembles and kinetics. Extending all-atom generative models to explicitly represent ensembles and transition pathways, perhaps via hybrid diffusion–MD frameworks, is a central challenge.

## Data, Generalization, and Bias

Training data combine PDB, AlphaFold, and curated complexes, but important classes (e.g., membrane proteins, RNA-centric complexes) remain underrepresented. Understanding and mitigating biases, and improving out-of-distribution robustness, are critical for reliable deployment.

## Multi-Objective Design and Real-World Constraints

Beyond binding, real-world design must consider expression, stability, developability, toxicity, and immunogenicity. Incorporating multiple property predictors into the generative process, and calibrating them against experimental outcomes, is essential for translating structural success into therapeutic impact.

# Stepwise Plan for a Unified All-Atom Design Program

To operationalize the framework described above, we outline a 24-step plan, grouped into conceptual phases that align with the main sections of this report.

## Phase I: Foundations and Data (Steps 1–5)

1.  **Define target design tasks and conditioning schema** ![C](https://latex.codecogs.com/png.latex?C "C") (binder design, pocket redesign, interface engineering; epitopes, ligands, nucleic acids, hydrogen bonds, SASA).

2.  **Curate and standardize structural data** from PDB and high-confidence AlphaFold(-multimer/3) predictions, including protonation, charge assignment, and component annotation.

3.  **Construct unified all-atom graphs** ![\mathcal{G} = (\mathcal{V},\mathcal{E},X,Z,C)](https://latex.codecogs.com/png.latex?%5Cmathcal%7BG%7D%20%3D%20%28%5Cmathcal%7BV%7D%2C%5Cmathcal%7BE%7D%2CX%2CZ%2CC%29 "\mathcal{G} = (\mathcal{V},\mathcal{E},X,Z,C)") with consistent atom, bond, and conditioning features.

4.  **Augment with AlphaFold3 complexes**, generating multi-component structures for underrepresented interaction types and design-relevant targets.

5.  **Define training splits and weighting** ![w_d](https://latex.codecogs.com/png.latex?w_d "w_d") based on experimental resolution and AF3 confidence to form ![\mathcal{D}\_{\text{AF3+PDB}}](https://latex.codecogs.com/png.latex?%5Cmathcal%7BD%7D_%7B%5Ctext%7BAF3%2BPDB%7D%7D "\mathcal{D}_{\text{AF3+PDB}}").

## Phase II: Model Architecture and Training (Steps 6–12)

1.  **Specify the diffusion process** (noise schedule ![\beta(t)](https://latex.codecogs.com/png.latex?%5Cbeta%28t%29 "\beta(t)"), discretization steps ![K](https://latex.codecogs.com/png.latex?K "K"), forward and reverse SDEs) over all-atom coordinates.

2.  **Design the equivariant backbone** with message-passing blocks, sparse attention patterns, and component-level tokens, ensuring ![\mathrm{E}(3)](https://latex.codecogs.com/png.latex?%5Cmathrm%7BE%7D%283%29 "\mathrm{E}(3)")-equivariance.

3.  **Implement conditioning channels** for atom-level (![c_i^{\text{atom}}](https://latex.codecogs.com/png.latex?c_i%5E%7B%5Ctext%7Batom%7D%7D "c_i^{\text{atom}}")), residue-level (![c_i^{\text{res}}](https://latex.codecogs.com/png.latex?c_i%5E%7B%5Ctext%7Bres%7D%7D "c_i^{\text{res}}")), and global (![C^{\text{global}}](https://latex.codecogs.com/png.latex?C%5E%7B%5Ctext%7Bglobal%7D%7D "C^{\text{global}}")) information, including hydrogen bonds and SASA.

4.  **Add discrete heads** for atom types and protein sequences, and auxiliary regressors for SASA and other geometric quantities.

5.  **Define the composite loss** ![\mathcal{L}\_{\text{RFD3}}](https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7B%5Ctext%7BRFD3%7D%7D "\mathcal{L}_{\text{RFD3}}") combining diffusion, geometric, atom-type, sequence, hydrogen-bond, and SASA terms, with appropriate weights.

6.  **Train the RFdiffusion3-style model** on ![\mathcal{D}\_{\text{AF3+PDB}}](https://latex.codecogs.com/png.latex?%5Cmathcal%7BD%7D_%7B%5Ctext%7BAF3%2BPDB%7D%7D "\mathcal{D}_{\text{AF3+PDB}}") using mixed-precision multi-GPU training, curriculum over system size, and regular monitoring of structural metrics.

7.  **Implement and train the Boltz-2-style model** for structure–affinity co-prediction, sharing equivariant backbones between pose and affinity heads and calibrating against experimental and FEP-derived ![\Delta G\_{\text{bind}}](https://latex.codecogs.com/png.latex?%5CDelta%20G_%7B%5Ctext%7Bbind%7D%7D "\Delta G_{\text{bind}}").

## Phase III: Integration with AlphaFold3 and FEP (Steps 13–18)

1.  **Integrate AlphaFold3 priors** into generative workflows, using AF3 structures ![X^{\text{AF3}}](https://latex.codecogs.com/png.latex?X%5E%7B%5Ctext%7BAF3%7D%7D "X^{\text{AF3}}") as initial conditions for diffusion with confidence-adapted noise levels.

2.  **Develop AF3-based validation pipelines**, including computation of ![\mathrm{RMSD}\_{\text{AF3}}](https://latex.codecogs.com/png.latex?%5Cmathrm%7BRMSD%7D_%7B%5Ctext%7BAF3%7D%7D "\mathrm{RMSD}_{\text{AF3}}"), ![\bar{q}\_{\text{int}}](https://latex.codecogs.com/png.latex?%5Cbar%7Bq%7D_%7B%5Ctext%7Bint%7D%7D "\bar{q}_{\text{int}}"), and ![S\_{\text{AF3}}](https://latex.codecogs.com/png.latex?S_%7B%5Ctext%7BAF3%7D%7D "S_{\text{AF3}}") for designed complexes.

3.  **Implement AF3+Boltz-2 ensemble scoring**, using AF3 pose ensembles and Boltz-2 predictions to compute AF3-weighted ![\hat{\Delta G}\_{\text{AF3-ens}}](https://latex.codecogs.com/png.latex?%5Chat%7B%5CDelta%20G%7D_%7B%5Ctext%7BAF3-ens%7D%7D "\hat{\Delta G}_{\text{AF3-ens}}").

4.  **Define FEP refinement protocols** for a selected subset of high-priority designs, including alchemical paths and convergence diagnostics.

5.  **Establish calibration loops** where FEP results and experimental data are used to fine-tune Boltz-2 and to adjust guidance strengths in generative models.

6.  **Automate cross-checks** between AF3, RFD3, Boltz-2, and FEP outputs to detect inconsistencies and flag designs requiring additional scrutiny.

## Phase IV: Benchmarking and Deployment (Steps 19–24)

1.  **Design benchmark suites** spanning protein–protein, protein–ligand, and protein–nucleic-acid tasks with reference structures and affinities.

2.  **Quantify runtime and scaling**, measuring per-design runtimes ![T(N)](https://latex.codecogs.com/png.latex?T%28N%29 "T(N)") and fitting scaling exponents ![\alpha](https://latex.codecogs.com/png.latex?%5Calpha "\alpha") for different architectures and sparsity patterns.

3.  **Evaluate structural quality** using backbone and all-atom RMSDs, hydrogen-bond recall, ![\Delta \mathrm{SASA}](https://latex.codecogs.com/png.latex?%5CDelta%20%5Cmathrm%7BSASA%7D "\Delta \mathrm{SASA}"), and AF3 consistency metrics.

4.  **Assess affinity prediction accuracy** of Boltz-2 and hybrid AF3+Boltz-2 ensembles against experimental and FEP benchmarks.

5.  **Simulate end-to-end campaigns**, estimating timeline compression and hit rates under different design–score–refine strategies (RFD2 vs. RFD3, with and without surrogates and FEP).

6.  **Deploy in real design projects**, integrating human-in-the-loop workflows, monitoring out-of-distribution behavior, and iteratively refining models and protocols based on experimental feedback.

This 24-step plan provides a concrete roadmap from data curation and model training to integrated deployment in drug discovery and biomolecular engineering, closely aligned with the conceptual and methodological framework developed in this report.

# Conclusion

All-atom generative models, structure–affinity surrogates, and multi-component structural oracles such as AlphaFold3 collectively enable a new regime of biomolecular design: atomic-resolution, multi-modal, and tightly integrated with both physics-based simulation and experiment. By unifying equivariant diffusion, sparse attention, Boltz-2-style co-prediction, and AF3 priors, the framework presented here delivers:

- an order-of-magnitude speedup over residue-level pipelines;

- improved all-atom structural and interface quality;

- stronger predicted affinities and better agreement with independent structural oracles;

- a clear path to integrating FEP for high-accuracy refinement.

At the same time, substantial challenges remain in ensuring thermodynamic consistency, capturing ensembles and dynamics, handling out-of-distribution conditions, and incorporating multi-objective constraints relevant to real-world therapeutics. Addressing these challenges will require continued advances in model architecture, physics-informed learning, data curation, and experimental integration. The methodology and stepwise plan laid out in this report are intended as a foundation for such efforts, supporting the transition from proof-of-concept demonstrations to reliable, industrial-scale, all-atom biomolecular design.
